---
import Layout from '@/layouts/Layout.astro';
import PriceChart from '@/components/PriceChart.tsx';
import { connection } from '@/lib/db';
import { ObjectId } from 'mongodb';

const db = await connection();
const collection = db.collection('products');

const { id } = Astro.params;
const product = await collection.findOne({ _id: new ObjectId(id) });
---

<Layout>
  <h1 class="font-medium text-3xl font-cabinet-grotesk">{product.title}</h1>
  <p>{product.description}</p>
  <PriceChart client:load />
</Layout>
